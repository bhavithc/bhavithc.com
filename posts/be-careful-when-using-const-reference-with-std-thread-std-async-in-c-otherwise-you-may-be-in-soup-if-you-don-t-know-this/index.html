<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don’t know this ! :)" /><meta property="og:locale" content="en" /><meta name="description" content="From the basics of C and C++. we all know that when we use address-of operator to the variable, then it is an alias of the original variable it points to, and shares the same address." /><meta property="og:description" content="From the basics of C and C++. we all know that when we use address-of operator to the variable, then it is an alias of the original variable it points to, and shares the same address." /><link rel="canonical" href="https://bhavithc.github.io/posts/be-careful-when-using-const-reference-with-std-thread-std-async-in-c-otherwise-you-may-be-in-soup-if-you-don-t-know-this/" /><meta property="og:url" content="https://bhavithc.github.io/posts/be-careful-when-using-const-reference-with-std-thread-std-async-in-c-otherwise-you-may-be-in-soup-if-you-don-t-know-this/" /><meta property="og:site_name" content="Bhavith C" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-25T13:42:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don’t know this ! :)" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-18T00:35:43+05:30","datePublished":"2022-04-25T13:42:00+05:30","description":"From the basics of C and C++. we all know that when we use address-of operator to the variable, then it is an alias of the original variable it points to, and shares the same address.","headline":"Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don’t know this ! :)","mainEntityOfPage":{"@type":"WebPage","@id":"https://bhavithc.github.io/posts/be-careful-when-using-const-reference-with-std-thread-std-async-in-c-otherwise-you-may-be-in-soup-if-you-don-t-know-this/"},"url":"https://bhavithc.github.io/posts/be-careful-when-using-const-reference-with-std-thread-std-async-in-c-otherwise-you-may-be-in-soup-if-you-don-t-know-this/"}</script><title>Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don't know this ! :) | Bhavith C</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Bhavith C"><meta name="application-name" content="Bhavith C"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/images/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Bhavith C</a></div><div class="site-subtitle font-italic">The more you teach more you grow</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/bhavithc" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['bhavithc.acharya','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don't know this ! :)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don't know this ! :)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/bhavithc">Bhavith C</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1650874320" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-25 </em> </span> <span> Updated <em class="timeago" data-ts="1652814343" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-18 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1161 words"> <em>6 min</em> read</span> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7221956227656629" crossorigin="anonymous"></script></div></div></div><div class="post-content"><p>From the basics of C and C++. we all know that when we use address-of operator to the variable, then it is an alias of the original variable it points to, and shares the same address.</p><p>Example:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'b' in foo  is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="n">foo</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'a' in main is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>output</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Address of variable <span class="s1">'b'</span> <span class="k">in </span>foo  is 0x7ffcb65f3084
Address of variable <span class="s1">'a'</span> <span class="k">in </span>main is 0x7ffcb65f3084
</pre></table></code></div></div><p>From the above example you can see address of <code class="language-plaintext highlighter-rouge">b</code> used in function foo is same as address of variable <code class="language-plaintext highlighter-rouge">a</code> used in main function because we used reference (address-of operator) <code class="language-plaintext highlighter-rouge">const int&amp; b</code></p><p>Also the value of <code class="language-plaintext highlighter-rouge">b</code> cannot be changed, since its a <code class="language-plaintext highlighter-rouge">const</code> variable</p><h4 id="fun-begins-now-lets-call-the-function-foo-in-a-thread-using-stdthread-and-see-the-output-of-below-code"><span class="mr-2">Fun begins now, lets call the function <code class="language-plaintext highlighter-rouge"><span class="mr-2">foo</code> in a thread using <code class="language-plaintext highlighter-rouge"><span class="mr-2">std::thread</code> and see the output of below code</span><a href="#fun-begins-now-lets-call-the-function-foo-in-a-thread-using-stdthread-and-see-the-output-of-below-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;thread&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'b' in foo  is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">t</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>


    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'a' in main is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>


    <span class="n">t</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>output</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Address of variable <span class="s1">'a'</span> <span class="k">in </span>main is 0x7ffc4d4126cc
Address of variable <span class="s1">'b'</span> <span class="k">in </span>foo  is 0x563b96627eb8
</pre></table></code></div></div><h4 id="what-the-heck-whats-happening-here"><span class="mr-2">What the heck? what’s happening here?</span><a href="#what-the-heck-whats-happening-here" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Here we have passed the value <code class="language-plaintext highlighter-rouge">a</code> as argument to function <code class="language-plaintext highlighter-rouge">foo</code> and received as reference too. but what happened? Before answering to the question lets remove <code class="language-plaintext highlighter-rouge">const</code> from the argument of function <code class="language-plaintext highlighter-rouge">foo</code> and see what happens</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">int</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'b' in foo  is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>output</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>bhavith <span class="nv">$ </span> g++ test.cpp <span class="nt">-pthread</span>
In file included from m2.cpp:2:
/usr/include/c++/9/thread: In instantiation of ‘std::thread::thread<span class="o">(</span>_Callable&amp;&amp;, _Args&amp;&amp; ...<span class="o">)</span> <span class="o">[</span>with _Callable <span class="o">=</span> void <span class="o">(</span>&amp;<span class="o">)(</span>int&amp;<span class="o">)</span><span class="p">;</span> _Args <span class="o">=</span> <span class="o">{</span>int&amp;<span class="o">}</span><span class="p">;</span> &lt;template-parameter-1-3&gt; <span class="o">=</span> void]’:
m2.cpp:13:25:   required from here
/usr/include/c++/9/thread:120:44: error: static assertion failed: std::thread arguments must be invocable after conversion to rvalues
  120 |           typename decay&lt;_Args&gt;::type...&gt;::value,
      |                                            ^~~~~
/usr/include/c++/9/thread: In instantiation of ‘struct std::thread::_Invoker&lt;std::tuple&lt;void <span class="o">(</span><span class="k">*</span><span class="o">)(</span>int&amp;<span class="o">)</span>, int&gt; <span class="o">&gt;</span>’:
/usr/include/c++/9/thread:131:22:   required from ‘std::thread::thread<span class="o">(</span>_Callable&amp;&amp;, _Args&amp;&amp; ...<span class="o">)</span> <span class="o">[</span>with _Callable <span class="o">=</span> void <span class="o">(</span>&amp;<span class="o">)(</span>int&amp;<span class="o">)</span><span class="p">;</span> _Args <span class="o">=</span> <span class="o">{</span>int&amp;<span class="o">}</span><span class="p">;</span> &lt;template-parameter-1-3&gt; <span class="o">=</span> void]’
m2.cpp:13:25:   required from here
/usr/include/c++/9/thread:243:4: error: no <span class="nb">type </span>named ‘type’ <span class="k">in</span> ‘struct std::thread::_Invoker&lt;std::tuple&lt;void <span class="o">(</span><span class="k">*</span><span class="o">)(</span>int&amp;<span class="o">)</span>, int&gt; <span class="o">&gt;</span>::__result&lt;std::tuple&lt;void <span class="o">(</span><span class="k">*</span><span class="o">)(</span>int&amp;<span class="o">)</span>, int&gt; <span class="o">&gt;</span>’
  243 |    _M_invoke<span class="o">(</span>_Index_tuple&lt;_Ind...&gt;<span class="o">)</span>
      |    ^~~~~~~~~
/usr/include/c++/9/thread:247:2: error: no <span class="nb">type </span>named ‘type’ <span class="k">in</span> ‘struct std::thread::_Invoker&lt;std::tuple&lt;void <span class="o">(</span><span class="k">*</span><span class="o">)(</span>int&amp;<span class="o">)</span>, int&gt; <span class="o">&gt;</span>::__result&lt;std::tuple&lt;void <span class="o">(</span><span class="k">*</span><span class="o">)(</span>int&amp;<span class="o">)</span>, int&gt; <span class="o">&gt;</span>’
  247 |  operator<span class="o">()()</span>
      |  ^~~~~~~~
</pre></table></code></div></div><p>What the hell? We are getting compilation error. The important error message to observe is</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>/usr/include/c++/9/thread:120:44: error: static assertion failed: std::thread arguments must be invocable after conversion to rvalues
  120 |           typename decay&lt;_Args&gt;::type...&gt;::value,
      |                                            ^~~~~
</pre></table></code></div></div><p>it is complaining that the value passed as a second argument to <code class="language-plaintext highlighter-rouge">thread</code> is not a <code class="language-plaintext highlighter-rouge">rvalue</code>, we need to convert to <code class="language-plaintext highlighter-rouge">rvalue</code> before sending. What is <code class="language-plaintext highlighter-rouge">rvalue</code> is an another topic and discuss later.</p><p>How to convert the argument to <code class="language-plaintext highlighter-rouge">rvalue</code>?</p><p>Just we need to use <code class="language-plaintext highlighter-rouge">std::ref</code> class to convert to <code class="language-plaintext highlighter-rouge">rvalue</code>. i.e. while calling in thread we need to use like below</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="nf">t</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>
</pre></table></code></div></div><p>Note: we wrapper <code class="language-plaintext highlighter-rouge">a</code> with <code class="language-plaintext highlighter-rouge">std::ref</code>. In this case we created a <code class="language-plaintext highlighter-rouge">std::ref</code> object and passed to the argument of function <code class="language-plaintext highlighter-rouge">foo</code> in thread.</p><p>Now lets see the result after fixing the compilation error</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Address of variable <span class="s1">'a'</span> <span class="k">in </span>main is 0x7ffc6e26dab4
Address of variable <span class="s1">'b'</span> <span class="k">in </span>foo  is 0x7ffc6e26dab4
</pre></table></code></div></div><p>What the hell it is? Now address of both <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code> is same, as soon as we remove the <code class="language-plaintext highlighter-rouge">const</code> from argument variable</p><h3 id="in-order-to-understand-this-behavior-we-need-to-understand-two-things-that-how-intelligently-the-stdthread-is-implemented"><span class="mr-2">In order to understand this behavior we need to understand two things that how intelligently the std::thread is implemented</span><a href="#in-order-to-understand-this-behavior-we-need-to-understand-two-things-that-how-intelligently-the-stdthread-is-implemented" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="when-const-with-argument-is-used-how-stdthread-behaves-"><span class="mr-2">When <code class="language-plaintext highlighter-rouge"><span class="mr-2">const</code> with argument is used how std::thread behaves ?</span><a href="#when-const-with-argument-is-used-how-stdthread-behaves-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>When <code class="language-plaintext highlighter-rouge">const</code> with argument is used, we know we are not going to modify the variable any way inside function <code class="language-plaintext highlighter-rouge">foo</code> and also compiler will not allow you to do so, then making a reference or alias to original variable may not be thread safe even though if we lock the variable. Because, during the execution of the thread, the passed variable to function <code class="language-plaintext highlighter-rouge">foo</code> may changed by <code class="language-plaintext highlighter-rouge">main</code> function. Therefore in order to make thread safe <code class="language-plaintext highlighter-rouge">std::thread</code> makes a copy of the variable and uses it. So that the copied variable is local to the function and all the local variable to the function is always thread safe</p><h4 id="when-const-is-not-used-with-the-argument-how-stdthread-behaves-"><span class="mr-2">When <code class="language-plaintext highlighter-rouge"><span class="mr-2">const</code> is not used with the argument how std::thread behaves ?</span><a href="#when-const-is-not-used-with-the-argument-how-stdthread-behaves-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>When <code class="language-plaintext highlighter-rouge">const</code> is not used with the argument of function <code class="language-plaintext highlighter-rouge">foo</code>, then <code class="language-plaintext highlighter-rouge">std::thread</code> will not make a copy of the variable, Because making a copy will make no sense because changing the variable in <code class="language-plaintext highlighter-rouge">main</code> function will not reflect in the function <code class="language-plaintext highlighter-rouge">foo</code> and the entire program will not work as expected. Now, in this case it leaves to user of <code class="language-plaintext highlighter-rouge">std::thread</code> to take care of thread safety. That means you know what you are doing.</p><h3 id="the-behavior-is-same-wrt-stdasync"><span class="mr-2">The behavior is same w.r.t std::async</span><a href="#the-behavior-is-same-wrt-stdasync" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><em>With <code class="language-plaintext highlighter-rouge">const</code> reference</em></p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;future&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'b' in foo  is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">f</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">async</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>


    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'a' in main is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>


    <span class="n">f</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>output</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Address of variable <span class="s1">'a'</span> <span class="k">in </span>main is 0x7ffd413ceedc
Address of variable <span class="s1">'b'</span> <span class="k">in </span>foo  is 0x55758197bef8
</pre></table></code></div></div><p>Addresses are different</p><p><em>Without <code class="language-plaintext highlighter-rouge">const</code> reference</em></p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;future&gt;</span><span class="cp">
</span>

<span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">int</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'b' in foo  is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">f</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">async</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>


    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Address of variable 'a' in main is "</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>


    <span class="n">f</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>output</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Address of variable <span class="s1">'a'</span> <span class="k">in </span>main is 0x7ffcd6428a94
Address of variable <span class="s1">'b'</span> <span class="k">in </span>foo  is 0x7ffcd6428a94
</pre></table></code></div></div><p>Shares the same address</p><h3 id="summary"><span class="mr-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>Be careful when working with reference and <code class="language-plaintext highlighter-rouge">std::thread</code> / <code class="language-plaintext highlighter-rouge">std::async</code>. I recommend to always to use <code class="language-plaintext highlighter-rouge">const</code> reference since it makes sure shared variables are thread safe provided you don’t want to modify the variable during the execution of the thread.</p></blockquote><div class="table-wrapper"><table><thead><tr><th>Function argument<th>Variable passed to thread as<th>Address<tbody><tr><td>const reference<td>a<td>different address<tr><td>const reference<td>std::ref(a)<td>same address<tr><td>reference<td>std::ref(a)<td>same address</table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/c-or-cpp/'>c++ or cpp</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/c/" class="post-tag no-text-decoration" >c++</a> <a href="/tags/threading/" class="post-tag no-text-decoration" >threading</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don&#39;t know this ! :) - Bhavith C&amp;url=https://bhavithc.github.io/posts/be-careful-when-using-const-reference-with-std-thread-std-async-in-c-otherwise-you-may-be-in-soup-if-you-don-t-know-this/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don&#39;t know this ! :) - Bhavith C&amp;u=https://bhavithc.github.io/posts/be-careful-when-using-const-reference-with-std-thread-std-async-in-c-otherwise-you-may-be-in-soup-if-you-don-t-know-this/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://bhavithc.github.io/posts/be-careful-when-using-const-reference-with-std-thread-std-async-in-c-otherwise-you-may-be-in-soup-if-you-don-t-know-this/&amp;text=Be careful when using const reference with std::thread / std::async in C++. Otherwise you may be in soup if you don&#39;t know this ! :) - Bhavith C" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/design-patterns-intents-and-motivations/">Design Patterns Intents and Motivations</a><li><a href="/posts/adapter-design-pattern/">Adapter design pattern</a><li><a href="/posts/c-notes/">C++ concepts covered most</a><li><a href="/posts/bashrc-vs-bash-profile/">.bashrc Vs .bash_profile</a><li><a href="/posts/lambda-expression-cheatsheet-in-c-cpp/">Lambda Expression Cheatsheet in C++/CPP</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c/">c++</a> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/design-pattern/">design-pattern</a> <a class="post-tag" href="/tags/pointers/">pointers</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/shellscript/">shellscript</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/threading/">threading</a> <a class="post-tag" href="/tags/alias/">alias</a> <a class="post-tag" href="/tags/aosp/">aosp</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/is-const-reference-always-thread-safe-when-used-as-function-parameter/"><div class="card-body"> <em class="timeago small" data-ts="1677002400" > 2023-02-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Is const reference always thread safe when used as function parameter?</h3><div class="text-muted small"><p> Many people has a fear of thread safety when using const reference as parameter to a function. As usual lets start with some examples and understand the thread safety of const reference Lets consi...</p></div></div></a></div><div class="card"> <a href="/posts/single-responsibility-principle/"><div class="card-body"> <em class="timeago small" data-ts="1655087220" > 2022-06-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Single Responsibility Principle</h3><div class="text-muted small"><p> There are five design principles and one among them is SRP (Single Responsibility Principle). it stated that Every class should have only one reason to change What does it means the only one reaso...</p></div></div></a></div><div class="card"> <a href="/posts/rule-of-three/"><div class="card-body"> <em class="timeago small" data-ts="1655400900" > 2022-06-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rule of three in c++</h3><div class="text-muted small"><p> There are three special functions in C++ class destructor copy constructor overload assignment operator If one of these functions is not defined by programmer, then compiler defines it for...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/if-you-know-this-in-shell-script-your-life-is-easy/" class="btn btn-outline-primary" prompt="Older"><p>If you know this in shell script your life is easy</p></a> <a href="/posts/pimpl/" class="btn btn-outline-primary" prompt="Newer"><p>pimpl in C++</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "bhavithc/bhavithc.com", "data-repo-id": "R_kgDOHOdRFA", "data-category": "Q&A", "data-category-id": "DIC_kwDOHOdRFM4CP3sL", "data-mapping": "title", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/bhavithc">Bhavith C</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c/">c++</a> <a class="post-tag" href="/tags/cpp/">cpp</a> <a class="post-tag" href="/tags/design-pattern/">design-pattern</a> <a class="post-tag" href="/tags/pointers/">pointers</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/shellscript/">shellscript</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/threading/">threading</a> <a class="post-tag" href="/tags/alias/">alias</a> <a class="post-tag" href="/tags/aosp/">aosp</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-E982BN4KB4"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-E982BN4KB4'); }); </script>
